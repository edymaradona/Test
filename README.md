# Test
Top10 Insufficient Transport Layer Protection（傳輸層保護不足） 對要連結的網站加入 basename() 語法，返回內部有的網站，不會導到其他網 站。 Top8 Unvalidated Redirects and Forwards（未驗證的導向） 導入扣款網站是使用 Get 來傳遞價格，簡單就可以改變。基本上用 Get 傳資料還 是很危險的… Fgetcsv() 解析 csv 格式檔案 file_put_contents(檔名, 內容) 寫入檔案 解決方法 1 確定是從購買網站進入，且比對 Session 才可以完成付費。 preg_match(正規表示條件, 要比對的字串) $_SERVER['HTTP_REFERER'] 前一個網頁的位置 解決方法 2 利用 sha1(microtime()) 以當前微秒加密後設定 token 變數與 session ，然後進 入購買網站後比對我傳入(get)的 token，與我的 session 比對。 &lt;input type="hidden" name="token" value="&lt;?php print($token);?> 設定 token if( $_SESSION['login'] != 'admin' || $_SESSION['token'] != $_GET['token'] ){ 比對 Top7 Failure to Restrict URL Access（限制 URL 存取失敗） 未經過登入畫面進入 admin.php 網頁 解決方法 登入後要設定 session 且要比對 session，若未設定 session 就進入 unsafe.php 網 頁。 $_SESSION[‘’] 此值是設定在伺服器上，可以防止權限不足而進入網站問題 Top5 預設密碼一定要改掉，下方網址有產品的預設帳號與密碼 http://www.defaultpassword.com/ Top4 直接修改 login 的使用者，即可進入受害者的網頁 owasp_lab2/member.php?login=user 解決方法 登入後要設定 session 且要比對 session，跟上方的 Top7 一樣 Top3 Cross-Site Scripting (XSS) 在留言板上傳入可執行的程式 解決方法 輸出內容改成 nl2br(htmlentities(內容)) nl2br() &lt;br/>取代分行字元(\n) htmlentities() 將特殊字元轉為 html 實體參照 符號 轉換後 符號 轉換後 &amp; &amp;amp; “ &amp;quot; ‘ &amp;#039; &lt; &amp;lt; > &amp;gt; Top2 Broken Authentication and Session Management 解決方法 設定 TimeOut 過期時間 start_session(600); 600 秒後過期 ID 不要當成 URL 傳遞 資料加密 Top1 Injection 只要在帳號打上 OR ‘’=’’ 帳號部分就一定可以成立 而#是 Sql 的註解語法，讓密碼可以不用判斷。所以密碼隨便打都可以進入。 解決方式 使用 PDO (PHP Data Object) 簡略說明，若有更多疑問請看老師的投影片！
